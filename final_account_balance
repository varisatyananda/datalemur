/*
 * Company: PayPal
 * Title: Final Account Balance
 * 
 * Given a table containing information about bank deposits and withdrawals made using Paypal,
 * write a query to retrieve the final account balance for each account,
 * taking into account all the transactions recorded in the table with the assumption that there are no missing transactions.
 */

-- Create table "transactions"
create table transactions(
	transaction_id integer primary key,
	account_id integer,
	amount decimal(4, 2),
	transaction_type varchar(50)
);

-- Insert sample values into "transactions" table
insert into transactions
values
	(123, 101, 10.00, 'Deposit'),
	(124, 101, 20.00, 'Deposit'),
	(126, 201, 10.00, 'Deposit'),
	(125, 101, 5.00, 'Withdrawal'),
	(128, 201, 10.00, 'Withdrawal'),
	(130, 301, 98.00, 'Deposit'),
	(132, 301, 36.00, 'Withdrawal'),
	(140, 201, 16.00, 'Deposit');

-- Solution
select
	account_id,
	sum(
		case
			when transaction_type = 'Deposit'
			then amount
			else -amount
		end
) final_balance
from transactions
group by account_id;
