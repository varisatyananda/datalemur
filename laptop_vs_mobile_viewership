/*
 * Company: NY Times
 * Title: Laptop vs. Mobile Viewership
 * 
 * Assume you're given the table on user viewership categorised by device type where the three types are laptop, tablet, and phone.
 * Write a query that calculates the total viewership for laptops and mobile devices where mobile is defined as the sum of tablet and phone viewership.
 * Output the total viewership for laptops as laptop_reviews and the total viewership for mobile devices as mobile_views.
 */

-- Create type "device_type_list"
create type device_type_list as enum(
	'laptop',
	'tablet',
	'phone'
);

-- Create table "viewership"
create table viewership(
	user_id integer,
	device_type device_type_list,
	view_time timestamp
);

-- Insert sample values into "viewership" table
insert into viewership
values
	(123, 'tablet', '2022-01-02 00:00:00'),
	(125, 'laptop', '2022-01-07 00:00:00'),
	(128, 'laptop', '2022-02-09 00:00:00'),
	(129, 'phone', '2022-02-09 00:00:00'),
	(145, 'tablet', '2022-02-04 00:00:00');

-- Solution
select
	count(
		case
			when device_type = 'laptop'
			then 'laptop views'
		end
	) laptop_views,
	count(
		case
			when device_type in('tablet', 'phone')
			then 'mobile views'
		end
	) mobile_views
from viewership;
